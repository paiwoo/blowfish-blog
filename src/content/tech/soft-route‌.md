---
title: "软路由搭建"
draft: false
# categories: ["tech"]
tags: ["软路由","tech"]
summary: "一份可直接复制的完整实操文档，涵盖硬件清单、镜像烧录、网络拓扑、代理部署与落地节点挑选，适合跨境电商工作室零基础落地。"
---

## 1 硬件清单
| 名称 | 规格/数量 | 备注 |
|---|---|---|
| Redmi AX3000 路由 | 1 台 | 作为 AP 提供 Wi-Fi |
| 友善 R3S 盒子 | 1 台 | 软路由主机 |
| TF 卡 | 32 GB × 1 | 系统盘 |
| 读卡器 | 1 个 | 烧录用 |
| 网线 | 1 米 × 3 | LAN/WAN/桥接 |
| 烧录工具 | rufus-4.7.exe | Windows 可用 |

## 2 软件与镜像
- **烧录工具**：Rufus [官网下载](https://rufus.ie)  
- **镜像**：`immortalwrt-24101.img`  
  - 非同款设备可在 [固件选择器](https://firmware-selector.immortalwrt.org/) 搜索对应型号。

## 3 烧录与首次启动
1. TF 卡插入读卡器 → 电脑打开 **Rufus** → 选择 `immortalwrt-24101.img` → **开始**。  
2. **先插 TF 卡，再给 R3S 通电**（顺序不能反）。  
3. 观察 **SYS 灯**：先快闪 → 常亮，说明系统加载完成。  
4. 用网线连接 **R3S LAN 口** ↔ 电脑网口。  
5. 浏览器访问  http://192.168.1.1/cgi-bin/luci/ 默认密码为空。

## 4 网络拓扑替换
| 步骤 | 操作 | 说明 |
|---|---|---|
| 1 | **WAN 口接线** | 拔下原路由器 WAN 网线 → 插入 **R3S WAN 口**。 |
| 2 | **修改 LAN 网段** | 后台 **网络 → 接口 → LAN** → IP 改为 `192.168.2.1/24` → 保存并应用。 |
| 3 | **重登录** | 浏览器访问 `http://192.168.2.1/cgi-bin/luci/`。 |

> 90% 场景可直接上网；若不能，确认光猫已负责拨号（DHCP）。

## 5 小米路由器变 AP
1. 电脑网口 ↔ **小米路由器 LAN 口**。  
2. 访问 `http://192.168.31.1` → **上网设置 → 工作模式切换** → 选 **有线中继** → 保存。  
3. 网线：R3S **LAN 口** ↔ 小米 **WAN 口**。  
4. 手机/电脑连接小米 Wi-Fi，可正常访问国内网。

## 6 安装代理
> 路径：R3S 后台 → **系统 → 软件包**  

安装列表：
|---|---|
| **luci-i18n-passwall-zh-cn** | 必选代理 |
| **luci-i18n-ttyd-zh-cn** | 可选终端 |
| **lucit-theme-argon** | 可选美化 |

配置：
1. **服务 → PassWall → 节点列表** → 添加自建或订阅节点。  
2. **TCP/UDP 节点** 均选自建节点 → **主开关** 打开。  
3. **访问控制** → 添加常用设备 MAC（固定 MAC）。  
   - iOS：设置 → Wi-Fi → ⓘ → 关闭「私有地址」。  
   - Android：Wi-Fi → 高级 → 使用「设备 MAC」。  
   - Windows：`cmd → ipconfig /all` 查看物理地址。  
4. **分流规则** 选 **中国列表以外** + **ChinaDNS-NG** + **远程 DNS 最优** → 保存 & 应用。

## 7 落地节点 / VPS 选择
| 国家/地区 | 供应商 | 备注 |
|---|---|---|
| 越南 | [ipraft](https://ipraft.com/) | VPS 自建 3xui 多协议 |
| 新加坡 | [iproyal](https://dashboard.iproyal.com/) | HTTP/SOCKS5 |
| 巴西 | [iproyal](https://dashboard.iproyal.com/) | HTTP/SOCKS5 |

自建 3xui 教程：[duangvps 教程](https://www.duangvps.com/archives/2054)

---

## 8 检查清单
- [ ] R3S SYS 灯常亮  
- [ ] R3S WAN 口已接光猫  
- [ ] R3S LAN ↔ 小米 WAN  
- [ ] 小米 Wi-Fi 可上网  
- [ ] PassWall 节点已在线  
- [ ] 常用设备 MAC 已固定  
- [ ] 分流规则保存 & 应用  

完成以上步骤，工作室所有设备即可「无感知」跨境访问。

## 软路由伪装优势

> 软路由开 PassWall 比手机/电脑跑 Clash Verge 更安全？——**确实有一定道理**，但核心在**运行环境差异**而非软件本身。

| 维度 | 软路由 PassWall | 手机/电脑 Clash Verge |
|---|---|---|
| TLS 指纹 | 精简 OpenSSL，更像普通路由器 | 带 GUI 特征，易被识别 |
| 流量形态 | 7×24 多设备混合，家用宽带节奏 | 单一设备，长时间集中流量 |
| 出口 IP | 家宽段，无 VPS/机房标签 | 容易被行为模型标为代理 |
| 路由位置 | 网关层，无感分流，零漏 DNS | 需本机规则，配置失误即泄露 |

**结论**：软路由 PassWall 因“网络拓扑 + 朴素指纹 + 多设备混合”而更难被 DPI 识别，适合工作室零感知跨境。

---

## DNS 优选

美国节点

| 测试 IP | 平均延迟 |
|---|---|
| 8.8.8.8 | **117.7 ms** |
| 8.8.4.4 | 212.8 ms |
| 9.9.9.9 | 206.7 ms |
| 208.67.222.222 | 189.6 ms |
| 1.1.1.1 | 373.1 ms |
| 1.0.0.1 | 304.7 ms |

> **8.8.8.8 延迟最低**，美国节点下可直接作为远程 DNS。

越南 用1.1.1.1
新加坡 用1.1.1.1

---

## DNS 分流

远程 vs 直连 vs 分流

| 模式 | 优点 | 缺点 | 推荐场景 |
|---|---|---|---|
| **远程 DNS**<br>8.8.8.8 | 零泄露 | 国内域名也绕美，延迟高 | 极度隐私需求 |
| **直连 DNS**<br>223.5.5.5 | 国内秒开 | 解析记录全暴露 | 纯国内业务 |
| **DNS 分流** | 国内直连，国外远程 | 需维护名单 | 跨境电商 |

---

## DNS 分流引擎

dnsmasq vs chinadns-ng

| 特性 | dnsmasq | chinadns-ng |
|---|---|---|
| 性能 | 名单大时略慢 | 大名单更快 |
| 防泄漏 | 保守，默认丢弃可疑 | 快，偶误判 |
| IPv6 过滤 | 需额外规则 | 原生支持 |
| 配置难度 | 低，默认可用 | 需手动白/黑名单 |

**懒人选择**：  
- 家用/小白 → **dnsmasq**  
- 旁路由性能弱、名单上万 → **chinadns-ng**

---

## DNS 延迟测试

（PowerShell）

```powershell
"1.1.1.1","1.0.0.1","8.8.8.8","8.8.4.4","9.9.9.9","208.67.222.222","149.112.112.112" | %{
    $r = Test-Connection $_ -Count 20 -ErrorAction SilentlyContinue
    $avg = if ($r) { ($r | Measure-Object ResponseTime -Average).Average.ToString("0.0") } else { "超时" }
    "{0,-18} {1,6} ms" -f $_, $avg
}
```
在 MobaXterm 本地终端执行即可，谁的延迟低就选谁。

---

## CN2 vs IPLC 

| 维度 | CN2 GIA（电信精品网） | IPLC（国际专线） |
|---|---|---|
| 网络类型 | 公网链路，仍过墙 | 内网专线，不过墙 |
| 稳定性 | 高，偶尔波动 | 极高，接近 100 % |
| 延迟 | 低，30–60 ms | 极低，15–40 ms |
| 抗封锁 | 一般 | 极强 |
| 带宽单价 | ¥150–300 / 1 G / 月 | ¥600–1200 / 1 G / 月 |
| 适用场景 | 普通站点 / 游戏 / 企业公网访问 | 外贸直播 / 代理 / 私密业务 |

> **结论**：  
> 预算充足且对「抗封锁 + 低延迟」零容忍 → **选 IPLC**；  
> 预算有限、面向公网用户 → **选 CN2 GIA**。  

---